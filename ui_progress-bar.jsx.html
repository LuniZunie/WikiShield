<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>ui/progress-bar.jsx - WikiShield Documentation</title>
    
    <meta name="description" content="API documentation for WikiShield - Wikipedia anti-vandalism tool" />
    
        <meta name="keywords" content="wikishield, wikipedia, documentation, api, anti-vandalism" />
        <meta name="keyword" content="wikishield, wikipedia, documentation, api, anti-vandalism" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/LuniZunie/WikiShield" target="_blank" class="menu-item" id="github-link" >GitHub</a></h2><h2><a href="https://en.wikipedia.org/wiki/Wikipedia:WikiShield" target="_blank" class="menu-item" id="wikipedia-link" >Wikipedia</a></h2><h3>Modules</h3><ul><li><a href="module-core_killswitch.html">core/killswitch</a><ul class='members'><li data-type='member'><a href="module-core_killswitch.html#.killswitch_config">killswitch_config</a></li><li data-type='member'><a href="module-core_killswitch.html#.killswitch_status">killswitch_status</a></li></ul><ul class='methods'><li data-type='method'><a href="module-core_killswitch.html#.checkKillswitch">checkKillswitch</a></li><li data-type='method'><a href="module-core_killswitch.html#.startKillswitchPolling">startKillswitchPolling</a></li></ul></li></ul><h3>Classes</h3><ul><li><a href="AISettings.html">AISettings</a></li><li><a href="AboutSettings.html">AboutSettings</a></li><li><a href="AudioManager.html">AudioManager</a></li><li><a href="AudioSettings.html">AudioSettings</a></li><li><a href="GeneralSettings.html">GeneralSettings</a></li><li><a href="HighlightSettings.html">HighlightSettings</a></li><li><a href="NumericInput.html">NumericInput</a></li><li><a href="PlaylistController.html">PlaylistController</a></li><li><a href="ProgressBarComponent.html">ProgressBarComponent</a><ul class='methods'><li data-type='method'><a href="ProgressBarComponent.html#scheduleRemoval">scheduleRemoval</a></li><li data-type='method'><a href="ProgressBarComponent.html#updateProgress">updateProgress</a></li></ul></li><li><a href="QueueSettings.html">QueueSettings</a></li><li><a href="SaveSettings.html">SaveSettings</a></li><li><a href="SettingsCompactGrid.html">SettingsCompactGrid</a></li><li><a href="SettingsSection.html">SettingsSection</a></li><li><a href="StatisticsSettings.html">StatisticsSettings</a></li><li><a href="Toggle.html">Toggle</a></li><li><a href="UserList.html">UserList</a></li><li><a href="VolumeControl.html">VolumeControl</a></li><li><a href="WhitelistSettings.html">WhitelistSettings</a></li><li><a href="WikiShieldLog.html">WikiShieldLog</a><ul class='methods'><li data-type='method'><a href="WikiShieldLog.html#log">log</a></li></ul></li><li><a href="WikiShieldProgressBar.html">WikiShieldProgressBar</a><ul class='methods'><li data-type='method'><a href="WikiShieldProgressBar.html#cleanup">cleanup</a></li><li data-type='method'><a href="WikiShieldProgressBar.html#processQueue">processQueue</a></li><li data-type='method'><a href="WikiShieldProgressBar.html#remove">remove</a></li><li data-type='method'><a href="WikiShieldProgressBar.html#set">set</a></li></ul></li><li><a href="ZenSettings.html">ZenSettings</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ProgressBar">ProgressBar</a></li><li><a href="global.html#fullTrim">fullTrim</a></li><li><a href="global.html#hasApproxSubstring">hasApproxSubstring</a></li><li><a href="global.html#injectNamedStyles">injectNamedStyles</a></li><li><a href="global.html#injectStyles">injectStyles</a></li><li><a href="global.html#loadStyles">loadStyles</a></li><li><a href="global.html#useProgressBar">useProgressBar</a></li><li><a href="global.html#wikishieldStyling">wikishieldStyling</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">ui/progress-bar.jsx</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * WikiShieldProgressBar - React/Preact component for progress indicators
 * Provides both a React component and an imperative API for backward compatibility
 */
import { h, Component } from 'preact';
import { render } from 'preact';

/**
 * Progress Bar Component
 */
class ProgressBarComponent extends Component {
	constructor(props) {
		super(props);
		this.state = {
			text: '',
			width: 0,
			color: 'var(--main-blue)',
			opacity: 1,
			isVisible: true
		};
	}

	componentDidMount() {
		// Notify parent that component is ready
		if (this.props.onMount) {
			this.props.onMount(this);
		}
	}

	/**
	 * Update the progress bar
	 * @param {String} text The text to display
	 * @param {Number} width Percentage (0-1)
	 * @param {String} color CSS color for the bar
	 */
	updateProgress(text, width, color) {
		this.setState({
			text,
			width: Math.round(width * 100),
			color,
			opacity: 1,
			isVisible: true
		});

		// Auto-remove when complete
		if (width === 1) {
			this.scheduleRemoval(2000);
		}
	}

	/**
	 * Schedule removal of the progress bar
	 * @param {Number} time Time in ms before removal
	 */
	scheduleRemoval(time) {
		// Fade out
		setTimeout(() => {
			this.setState({ opacity: 0 });
		}, time - 300);

		// Remove
		setTimeout(() => {
			this.setState({ isVisible: false });
			if (this.props.onRemove) {
				this.props.onRemove();
			}
		}, time);
	}

	render() {
		const { text, width, color, opacity, isVisible } = this.state;

		if (!isVisible) {
			return null;
		}

		return (
			&lt;div
				className="progress-bar"
				style={{ opacity }}
			>
				&lt;div
					className="progress-bar-overlay"
					style={{ width: `${width}%` }}
				/>
				&lt;div className="progress-bar-text">
					{text}
				&lt;/div>
			&lt;/div>
		);
	}
}

/**
 * Imperative API wrapper for WikiShieldProgressBar
 * Maintains backward compatibility with the original class-based API
 */
export class WikiShieldProgressBar {
	constructor() {
		this.nextChangeTime = 0;
		this.updateQueue = [];
		this.componentRef = null;

		// Find or create container
		this.container = document.querySelector('#progress-bar-container');
		if (!this.container) {
			console.warn('Progress bar container not found');
			return;
		}

		// Create a wrapper div for this progress bar instance
		this.element = document.createElement('div');
		this.container.appendChild(this.element);

		// Render the React component
		render(
			&lt;ProgressBarComponent
				onMount={(ref) => {
					this.componentRef = ref;
					this.processQueue();
				}}
				onRemove={() => {
					this.cleanup();
				}}
			/>,
			this.element
		);
	}

	/**
	 * Set the progress bar
	 * @param {String} text The text to display
	 * @param {Number} width Percentage (0-1)
	 * @param {String} color CSS color for the bar
	 */
	set(text, width, color) {
		const delay = Math.max(0, this.nextChangeTime - Date.now());

		this.updateQueue.push({
			text,
			width,
			color,
			delay
		});

		this.nextChangeTime = Math.max(Date.now() + 200, this.nextChangeTime + 200);

		// Process queue if component is ready
		if (this.componentRef) {
			this.processQueue();
		}
	}

	/**
	 * Process queued updates
	 */
	processQueue() {
		while (this.updateQueue.length > 0 &amp;&amp; this.componentRef) {
			const update = this.updateQueue.shift();

			setTimeout(() => {
				if (this.componentRef) {
					this.componentRef.updateProgress(update.text, update.width, update.color);
				}
			}, update.delay);
		}
	}

	/**
	 * Remove the progress bar after a given time
	 * @param {Number} time The time to wait before removing the progress bar
	 */
	remove(time) {
		if (this.componentRef) {
			this.componentRef.scheduleRemoval(time);
		}
	}

	/**
	 * Cleanup when removing
	 */
	cleanup() {
		if (this.element &amp;&amp; this.element.parentNode) {
			// Unmount React component and remove element
			render(null, this.element);
			this.element.parentNode.removeChild(this.element);
		}
		this.componentRef = null;
		this.updateQueue = [];
	}
}

/**
 * React Hook for using progress bars in functional components
 * Example usage:
 *
 * const MyComponent = () => {
 *   const [progress, setProgress] = useProgressBar();
 *
 *   const doWork = async () => {
 *     setProgress('Working...', 0.5, 'blue');
 *     await someAsyncWork();
 *     setProgress('Done!', 1.0, 'green');
 *   };
 *
 *   return &lt;button onClick={doWork}>Start&lt;/button>;
 * };
 */
export function useProgressBar() {
	const progressBarRef = { current: null };

	const setProgress = (text, width, color = 'var(--main-blue)') => {
		if (!progressBarRef.current) {
			progressBarRef.current = new WikiShieldProgressBar();
		}
		progressBarRef.current.set(text, width, color);
	};

	return [progressBarRef, setProgress];
}

/**
 * Functional component version for direct use in JSX
 * Example:
 *
 * &lt;ProgressBar text="Loading..." width={0.5} color="blue" />
 */
export const ProgressBar = ({ text, width, color = 'var(--main-blue)', onComplete }) => {
	return (
		&lt;div className="progress-bar">
			&lt;div
				className="progress-bar-overlay"
				style={{
					width: `${Math.round(width * 100)}%`,
					background: color,
					transition: 'width 0.2s ease'
				}}
			/>
			&lt;div className="progress-bar-text">
				{text}
			&lt;/div>
		&lt;/div>
	);
};
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> on Wed Feb 25 2026 01:37:34 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
